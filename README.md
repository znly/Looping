# WebPImage

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![SwiftPM Support](https://img.shields.io/badge/SwiftPM-compatible-brightgreen.svg)](https://swift.org/package-manager/)
[![Carthage Support](https://img.shields.io/badge/Carthage-compatible-brightgreen.svg)](https://github.com/Carthage/Carthage)

A simple and lightweight framework to decode and display any static or animated WebP image using UIKit and SwiftUI.

### Next steps
- Implement `BackgroundBehavior` (restart, stop, resume)
- Add progressive decoding option
- Add native support on macOS

## Minimum deployment targets

+ iOS 8
+ macOS 10.15

## Dependencies

+ [WebP](https://github.com/znly/WebP)

In the example app we also make use of:
+ [GDPerformanceView-Swift](https://github.com/dani-gavrilov/GDPerformanceView-Swift)

## Project requirements

+ Xcode 11

## Installation

### SwiftPM (Xcode 11+)

[Swift Package Manager (SwiftPM)](https://swift.org/package-manager/) is dependency manager as well as a distribution tool.


From Xcode 11 onward, SwiftPM is natively integrated with Xcode. In `File -> Swift Packages -> Add Package Dependency`, search for WebPImage's repo URL.


If you're a framework author, you can add following the dependency to your `Package.swift`:
```swift
dependencies: [
    .package(url: "https://github.com/znly/WebPImage.git", .from("0.1.0"))
]
```

### Carthage

[Carthage](https://github.com/Carthage/Carthage) is a decentralized dependency manager that builds your dependencies and provides you with binary frameworks.

To integrate WebPImage into your Xcode project using Carthage, specify it in your Cartfile:
```
github "znly/WebPImage" ~> 0.1.0
```

## Usage

### ① Creating a `WebPImage`

The prefered method is to use `init(data:, scale:)`. Default scale is 1.0.
```swift
import WebPImage

let wpImageData: Data
let wpImage = try? WebPImage(data: wpImageData)
```

Additional convenience initializers are available: `init(url:)` and  `init(named:)`.
Note: If the file name contains a scale factor (eg: @{1,2,3}x) it will be applied to the image.

### ② Displaying a `WebPImage` using a `WebPImageView`

Rendering happens on a background thread. 

```swift
import WebPImage

let wpImageData: WebPImage
let wpImageView = WebPImageView(image: webPImage)
```

### ③ Converting a `WebPImage` frame into a `UIImage` or `CGImage`

Using the methods `WebPImage.cgImage(atFrame:)` or  `WebPImage.image(atFrame:)`.

Since retrieving the image of a WebP image at a specific frame requires to go over every intermediary frame to reconstruct the final image, it is recommended to call these methods outside of the main thread. 

```swift
import WebPImage

let wpImage: WebPImage
let cgImage: CGImage = wpImage.cgImage()
let image: UIImage = wpImage.image() // alternatively you can use UIImage(wpImage: wpImage)
```

## Documentation

[TODO] Use GitHub Pages to link to the documentation generated by swift doc

## Authors
See [AUTHORS](./AUTHORS) for the list of contributors.

## Credits
Assets used in the example app are taken from:
- https://developers.google.com/speed/webp/gallery
- https://mathiasbynens.be/demo/animated-webp
- http://littlesvr.ca/apng/gif_apng_webp.html
- https://github.com/iSparta/iSparta

Documentation was generated using:
- https://github.com/SwiftDocOrg/swift-doc

## License
The Apache License version 2.0 (Apache2) - see [LICENSE](./LICENSE) for more details.

Copyright © 2020 Zenly <hello@zen.ly> [@zenlyapp](https://twitter.com/zenlyapp)
